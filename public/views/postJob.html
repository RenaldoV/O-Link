<div class="container w-xxl w-auto-xs s" ng-controller="postJob">
    <div class="wrapper text-center">
        <strong>Post a Job</strong><br/>
    </div>

<form name="jobForm" class="list-group list-group-sm form-validation" ng-submit="submitForm()">
    <div class="text-danger wrapper text-center">

    </div>

    <h4 class="form-section-label">Job Details</h4>
    <div class="list-group list-group-sm form-group">
        <fieldset class="form-group">
            <div class="list-group-item">
                <input type="text" class="form-control no-border" placeholder="Job Role" ng-model="job.post.role" required>
            </div>
            <div class="list-group-item">
                <textarea id="jobDescr" rows=4 class="form-control no-border" placeholder="Description (100 - 500 characters)" ng-model="job.post.description" maxlength="500" minlength="100" required></textarea>
                <div id="textarea_feedback"></div>
            </div>
            <div class="list-group-item">
                <input type="text" id="searchTextField" class="form-control no-border" placeholder="Location" ng-model="job.post.location" required>
            </div>
            <div class="list-group-item">
                <select class="form-control no-border" ng-model="job.post.category" required>

                    <option value="" selected disabled>Select Category</option>
                    <option ng-repeat="category in categories" value="{{category}}">{{category}}</option>

                </select>
            </div>
        </fieldset>
    </div>

    <h4 class="form-section-label">Pay</h4>
    <div class="list-group list-group-sm form-group">
        <div class="list-group-item">
            <select id="period" class="form-control no-border" ng-model="job.post.timePeriod" required>
                <option value="" selected disabled>Time Period</option>

                <option ng-repeat="period in timePeriods" value="{{period.name}}">{{period.name}} ({{period.description}})</option>
            </select>
            <br>
            <div class="checkbox m-b-md m-t-none">
                <label class="i-checks">
                    <input type="checkbox" ng-model="job.post.sharedTips"><i></i>Shared Tips
                </label>
            </div>
            <div class="checkbox m-b-md m-t-none">
                <label class="i-checks">
                    <input type="checkbox" ng-model="job.post.individualTips"><i></i>Individual Tips
                </label>
            </div>
        </div>
        <div class="list-group-item">
            <input id="amount" name="amount"  type="text" step="any" class="controls form-control no-border" width="50px" placeholder="Amount" ng-model="job.post.pay" min="1" pattern="[1-9]\d*" required>
        </div>
    </div>

    <h4 id="datesLabel" class="form-section-label">Dates</h4>
    <div class="list-group list-group-sm form-group">
        <div class="list-group-item">
            <input id="startDate" type="text" class="controls form-control no-border" placeholder="Starting Date"  ng-model="job.post.startingDate" required>
        </div>
        <div id="endDateDiv" class="list-group-item" hidden="hidden">
            <input id="endDate" type="text" class="controls form-control no-border" placeholder="End Date" ng-model="job.post.endDate" >
        </div>
        <div class="list-group-item" id="times" hidden>

        </div>
    </div>

    <h4 class="form-section-label">Requirements</h4>
    <div class="list-group list-group-sm form-group">
        <div class="list-group-item">
            <select class="form-control no-border" id="stuGender" name="stuGender" ng-model="job.post.gender" required>
                <option value="" selected disabled>Gender</option>
                <option value="M">Male</option>
                <option value="F">Female</option>
                <option value="Any">Any</option>
            </select>
        </div>
        <div id="reqGroup" class="list-group-item">

            <div id="reqInputs">
                <div class="reqBox" ng-repeat="req in job.post.requirements">
                    <select class="form-control no-border" ng-model="req.name" ng-change="changeSub()" required>
                        <option value="" selected disabled>Choose Requirement</option>

                        <option ng-if="req.name == reqName || tempReq.indexOf(reqName) > -1 " ng-click="changeSub()" ng-repeat="reqName in reqNames" value="{{reqName}}">{{reqName}}</option>
                    </select>

                    <select name="how" class="form-control no-border" ng-model="req.symbol" required>
                        <option value="" selected disabled>Choose Symbol</option>
                        <option value="A">A (80-100%)</option>
                        <option value="B">B (70-79%)</option>
                        <option value="C">C (60-69%)</option>
                        <option value="D">D (50-59%)</option>
                        <option value="F">F (40-49%)</option>
                    </select>
                </div>
            </div>

            <div id="reqButtonGrp" class="btn-group-vertical" role="group">

                <button ng-if="job.post.requirements.length > 0" type="button" class="removeReq btn btn-default" ng-click="close(job.post.requirements)">Remove<span class="glyphicon glyphicon-minus"></span></button>
                <button type="button" id="addReq" class="btn btn-default" ng-click="add()">Add result requirement <span class="glyphicon glyphicon-plus"></span></button>
            </div>
            <br>
            <br>
            <div >
                <div class="reqBox" ng-repeat="req in job.post.experience">
                    <select class="form-control no-border" ng-model="req.category" ng-change="changeExp()" required>
                        <option value="" selected disabled>Choose Requirement</option>
                        <option ng-if="req.category == expName || tempExp.indexOf(expName) > -1 " ng-click="changeExp()" ng-repeat="expName in expNames" value="{{expName}}">{{expName}}</option>
                    </select>

                </div>
            </div>

            <div class="btn-group-vertical" role="group">

                <button ng-if="job.post.experience.length > 0" type="button" class="removeReq btn btn-default" ng-click="closeExp(job.post.experience)">Remove<span class="glyphicon glyphicon-minus"></span></button>
                <button type="button"  class="btn btn-default" ng-click="addExp()">Add experience requirement <span class="glyphicon glyphicon-plus"></span></button>
            </div>
            <br/>
            <br/>
            <div class="checkbox m-b-md m-t-none">
                <label class="i-checks">
                    <input type="checkbox" ng-model="job.post.driversLicense"><i></i>Drivers license required?
                </label>
            </div>
            <div class="checkbox m-b-md m-t-none">
                <label class="i-checks">
                    <input type="checkbox" ng-model="job.post.transport"><i></i>Own transport required?
                </label>
            </div>
            <div class="checkbox m-b-md m-t-none">
                <label class="i-checks">
                    <input type="checkbox" ng-model="job.post.interviewRequired"><i></i>Interview required?
                </label>
            </div>
        </div>


    </div>

    <br/>
    <h4 class="form-section-label">Thresholds <span title="Click here to find out more." class="threshTooltip glyphicon glyphicon-question-sign"></span></h4>
    <p id="threshInfo" hidden>The threshold is one of many things which makes O-Link different.
        You can limit the number of applications you would like to receive
        for each position / interview available. The threshold figure is the
        combination of positions / interviews you would like to fill and the
        maximum number of applications you would like per position /
        interview. i.e. If you have 2 jobs to fill, and would like a maximum of
        10 applicants per job, your threshold will be 20 applicants. When this
        threshold is reached, your offer will automatically be pulled from the
        visible job offers, preventing any unwanted applications. If you do
        not find the talent you are looking for from these 20 applicants, you
        will be able to repost the offer and let O-Link find you new
        applicants.<br/><br/>
        If you need any assistance, please email the O-Link team at
        info@olink.co.za and we will help you out in any way we can.</p>
    <div class="list-group list-group-sm form-group">
        <div class="list-group-item">
            <input id="spotsAvail" name="spotsAvail"  type="text" class="controls form-control no-border" width="50px" placeholder="Positions / Interviews Available" ng-model="job.post.spotsAvailable" pattern="[1-9]\d*" required>
        </div>
        <div class="list-group-item">
            <input id="threshold" name="threshold"  type="text" class="controls form-control no-border" width="50px" placeholder="Applicants per Position / Interview" ng-model="job.post.threshold" pattern="[1-9]\d*" required>
        </div>
    </div>

    <div id="postJobForm" class="list-group list-group-sm" >
        <button ng-if="!job.status" type="submit"  class="post-job-btn btn btn-lg btn-primary btn-block" >Post Job</button>
        <button ng-if="job.status == 'Completed'" type="submit"  class="post-job-btn btn btn-lg btn-primary btn-block" >RePost Job</button>
        <button ng-if="job.status == 'active'" type="submit"  class="post-job-btn btn btn-lg btn-primary btn-block" >Edit Job</button>
    </div>


    </form>
</div>

<script>
    $( ".threshTooltip" ).tooltip();
    $( ".threshTooltip" ).on("click", function() {
        $("#threshInfo").toggle();
    });

    //===================POST JOB VALIDATION==============
    $(function () {
        $("input[name=amount]").on("invalid", function () {
            this.setCustomValidity("Please enter a valid number.");
        });
        $("input[name=amount]").on("change", function () {
            this.setCustomValidity("");
        });
    });
    $(function () {
        $("input[name=spotsAvail]").on("invalid", function () {
            this.setCustomValidity("Please enter a valid number.");
        });
        $("input[name=spotsAvail]").on("change", function () {
            this.setCustomValidity("");
        });
    });
    $(function () {
        $("input[name=threshold]").on("invalid", function () {
            this.setCustomValidity("Please enter a valid number.");
        });
        $("input[name=threshold]").on("change", function () {
            this.setCustomValidity("");
        });
    });


    $('#startDate').datepicker({
        changeMonth: true,
        changeYear: true,
        minDate :0
        /*,
        onSelect: function(selected) {
            $("#endDate").datepicker("option","minDate", selected)
        }*/
    });
    $('#endDate').datepicker({
        changeMonth: true,
        changeYear: true
        /*,
        onSelect: function(selected) {
            $("#startDate").datepicker("option","maxDate", selected)
        }*/
    });
    $(function () {
        var text_max = 500;
        $('#textarea_feedback').html(text_max + ' remaining');

        $('#jobDescr').keyup(function() {
            var text_length = $('#jobDescr').val().length;
            var text_remaining = text_max - text_length;

            $('#textarea_feedback').html(text_remaining + ' remaining');
        });
    });
    $("#jobDescr").on("focusout", function () {
        if($("#jobDescr").val().length < 100 || ("#jobDescr").val().length < 500)
            this.setCustomValidity("Please enter more than 100 characters and less than 500 characters.");
        else
            this.setCustomValidity("");
    });
    $("#jobDescr").on("change", function () {
        this.setCustomValidity("");
    });


</script>